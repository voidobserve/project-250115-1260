C51 COMPILER V9.60.7.0   MAIN                                                              12/30/2025 09:37:03 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Release\Objects\main.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE ..\..\User\main.c LARGE OPTIMIZE(8,SPEED) BROWSE INTVECTOR(0X000C) INCDI
                    -R(..\..\Libraries\Include;..\..\User) INTERVAL(3) DEBUG OBJECTEXTEND PRINT(.\Release\Listings\main.lst) OBJECT(.\Release
                    -\Objects\main.obj)

line level    source

   1          #include <stdio.h>
   2          #include <math.h>
   3          
   4          #include "include.h"
   5          #include "main.h"
   6          
   7          
   8          
   9          /** @addtogroup Template_Project
  10           * @{
  11           */
  12          
  13          /* Private typedef -----------------------------------------------------------*/
  14          /* Private define ------------------------------------------------------------*/
  15          /* Private macro -------------------------------------------------------------*/
  16          /* Private variables ---------------------------------------------------------*/
  17          
  18          LED_S led_state;
  19          /* Private function prototypes -----------------------------------------------*/
  20          /* Private functions ---------------------------------------------------------*/
  21          
  22          /*********************************
  23          |--------------------------------|
  24          | ä½¿ç”¨%dæ‰“å°çš„æ•°å€¼ä¸å¯¹æ—¶ï¼Œè¯·æ³¨æ„ |
  25          |--------------------------------|
  26          | æ ¼å¼ |     å«ä¹‰     | é’ˆå¯¹ç±»å‹ |
  27          |------|--------------|----------|
  28          | %bd  | å•ä¸ªå­—èŠ‚å˜é‡ | char     |
  29          | % d  | ä¸¤ä¸ªå­—èŠ‚å˜é‡ | int      |
  30          | %ld  | å››ä¸ªå­—èŠ‚å˜é‡ | long int |
  31          |--------------------------------|
  32          **********************************/
  33          // é‡å†™puchar()å‡½æ•°,ç”¨äºæ ‡å‡†printf()å‡½æ•° (æ³¨æ„:ä½¿ç”¨printf()å‡½æ•°å ç”¨1kå·¦å³çš„codeç©ºé—´
             -)
  34          char putchar(char c)
  35          {
  36   1          debug_putchar(c);
  37   1      
  38   1          return c;
  39   1      }
  40          
  41          /**
  42           * @brief  Main program.
  43           * @param  None
  44           * @retval None
  45           */
  46          extern void timer4_cap_init(void);
  47          extern void timer0_init();
  48          extern void get_duty(void);
  49          extern void pwm_init(void);
  50          extern void option_fun(void);
  51          extern void init_lvd_4V(void);
  52          extern void init_lvd_3v(void);
C51 COMPILER V9.60.7.0   MAIN                                                              12/30/2025 09:37:03 PAGE 2   

  53          
  54          extern void lvd_handler(void);
  55          extern void adc_init();
  56          extern void adc_val();
  57          extern u16 ntc_val;
  58          extern u16 adjust_val;
  59          extern u16 ajust_duty;
  60          extern u16 adc0_val;
  61          extern u16 adc1_val;
  62          extern void adjust_pwm();
  63          extern u16 max_duty;
  64          extern u32 pwm_in_duty;
  65          extern bit dly_pwr_on;
  66          extern u8 simple_over;
  67          extern u16 max_duty;
  68          
  69          void main(void)
  70          {
  71   1      
  72   1          system_init();
  73   1      
  74   1          //  P1_MD1   &= ~GPIO_P15_MODE_SEL(0x03);
  75   1          //  P1_MD1   |=  GPIO_P15_MODE_SEL(0x01);
  76   1          //  P1_PU |= GPIO_P15_PULL_UP(1);
  77   1          //  P15 = 1;
  78   1      
  79   1          //  P1_MD1   &= ~GPIO_P16_MODE_SEL(0x03);
  80   1          //  P1_MD1   |=  GPIO_P16_MODE_SEL(0x01);
  81   1          //  P1_PU |= GPIO_P16_PULL_UP(1);
  82   1          //  P16 = 1;
  83   1          //          while(1)
  84   1          //    {
  85   1          //      WDT_KEY = WDT_KEY_VAL(0xAA);        // å–‚ç‹—å¹¶æ¸…é™¤ wdt_pending
  86   1          //          }
  87   1      
  88   1          //  delay_ms(5);
  89   1      #if 1
  90   1          // çœ‹é—¨ç‹—é»˜è®¤æ‰“å¼€, å¤ä½æ—¶é—´2s
  91   1          //    WDT_KEY = WDT_KEY_VAL(0xDD);               //  å…³é—­çœ‹é—¨ç‹— (å¦‚éœ€é…ç½®çœ‹é—¨ç‹—è¯·æŸ¥çœ‹â€
             -œWDT\WDT_Resetâ€ç¤ºä¾‹)
  92   1          led_state = LED_PWR_ON;
  93   1      
  94   1          delay_ms(10);
  95   1          // åˆå§‹åŒ–æ‰“å°
  96   1          debug_init();
  97   1          user_printf("TX8C126x_SDK main start\n");
  98   1          timer4_cap_init();
  99   1      
 100   1          __SetIRQnIP(TMR4_IRQn, TMR4_IQn_CFG);
 101   1          __SetIRQnIP(STMR0_IRQn, STMR0_IQn_CFG);
 102   1      
 103   1          timer0_init();
 104   1          pwm_init();
 105   1          adc_init();
 106   1          adc_val(); // åˆå§‹åŒ–æ—¶è¿è¡Œä¸€æ¬¡ï¼Œç”¨äºæ ‡å¿—ä½åˆ¤æ–­
 107   1          option_fun();
 108   1          printf("adc0_val = %d  adc1_val = %d \r\n ", adc0_val, adc1_val);
 109   1          init_lvd_3v();
 110   1          while (1)
 111   1          {
 112   2              WDT_KEY = WDT_KEY_VAL(0xAA); // å–‚ç‹—å¹¶æ¸…é™¤ wdt_pending
 113   2              get_duty();
C51 COMPILER V9.60.7.0   MAIN                                                              12/30/2025 09:37:03 PAGE 3   

 114   2              lvd_handler();
 115   2              // adc_val();//adcå€¼
 116   2              adjust_pwm(); // ç”µä½å™¨å€¼
 117   2              // dly_pwr_on =1;
 118   2          }
 119   1      #endif
 120   1      }
 121          
 122          /**
 123           * @}
 124           */
 125          
 126          /*************************** (C) COPYRIGHT 2021 HUGE-IC ***** END OF FILE *****/


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    132    ----
   CONSTANT SIZE    =     58    ----
   XDATA SIZE       =      1       1
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
